"undefined"==typeof document?(self._noTransferable=!0,self.onmessage=function(e){eval(e.data)}):!function(e){"use strict";function n(){var e,n=0,t=F;for(F=[];e=t[n++];)e()}function t(){function e(){this.then=function(e,t){return n(e,t)}}var n=function(e,a,c){if(e!==n){var u=r();return n.queue.push({deferred:u,resolve:e,reject:a}),u.promise}for(var f=a?"resolve":"reject",s=0,l=n.queue.length;l>s;s++){var _=n.queue[s],d=_.deferred,p=_[f];typeof p!==B?d[f](c):i(p,c,d)}n=o(t,c,a)},t=new e;this.promise=t,n.queue=[],this.resolve=function(e){n.queue&&n(n,!0,e)},this.fulfill=this.resolve,this.reject=function(e){n.queue&&n(n,!1,e)}}function r(){return new t}function o(e,n,t){return function(o,a){var c=t?o:a;if(typeof c!==B)return e;var u=r();return i(c,n,u),u.promise}}function i(e,n,t){M.nextTick(function(){try{var r=e(n);r&&typeof r.then===B?r.then(t.resolve,t.reject):t.resolve(r)}catch(o){t.reject(o)}})}function a(e){for(var n=e,t=!0,r={},o=function(e,n){n&&"importScripts("+n.split(",").forEach(function(e){r[M.makeUrl(e.match(/\s*[\'\"](\S*)[\'\"]\s*/)[1])]=!0})+");\n"};t;)t=n.match(/(importScripts\(.*?\);?)/),n=n.replace(/(importScripts\(\s*(?:[\'\"].*?[\'\"])?\s*\);?)/,"\n"),t&&t[0].replace(/importScripts\(\s*([\'\"].*?[\'\"])?\s*\);?/g,o);return r=Object.keys(r),[r,n]}function c(e,n){var t=a(e),r=t[0],o=t[1];return r.length>0?"importScripts('"+r.join("','")+n+o:o}function u(){if("undefined"!=typeof SHIM_WORKER_PATH)return SHIM_WORKER_PATH;if("SHIM_WORKER_PATH"in M)return M.SHIM_WORKER_PATH;for(var e=document.getElementsByTagName("script"),n=e.length,t=0;n>t;){if(/catiline(\.min)?\.js/.test(e[t].src))return e[t].src;t++}}function f(e,n){var t=e.createElement("script");"undefined"!=typeof t.text?t.text=n:t.innerHTML=n,"complete"===e.readyState?e.documentElement.appendChild(t):e.onreadystatechange=function(){"complete"===e.readyState&&e.documentElement.appendChild(t)}}function s(e,n){var t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t);var r=t.contentWindow.document,o=["try{ ","var __scripts__='';function importScripts(scripts){","	if(Array.isArray(scripts)&&scripts.length>0){","		scripts.forEach(function(url){","			var ajax = new XMLHttpRequest();","			ajax.open('GET',url,false);","			ajax.send();__scripts__+=ajax.responseText;","			__scripts__+='\\n;';","		});","	}","};",e,"}catch(e){","	window.parent.postMessage(['"+n+"','error'],'*')","}"].join("\n");return f(r,o),t}function l(e,n){var t=M.deferred();return"complete"===document.readyState?t.resolve(s(e,n)):window.addEventListener("load",function(){t.resolve(s(e,n))},!1),t.promise}function _(e){M._noTransferable=!0;var n=new Worker(u());return n.postMessage(e),n}function d(e){var n="{",t=!0;for(var r in e)t?t=!1:n+=",",n+=r,n+=":",n+=M.stringify(e[r]);return n+="}"}function p(e){if(e.length){var n="[";n+=M.stringify(e[0]);for(var t=0,r=e.length;++t<r;)n+=",",n+=M.stringify(e[t]);return n+="]"}return"[]"}function h(e,n){var t,r={};"undefined"!=typeof __self__?t=__self__.postMessage:n&&(t=n),e.on=function(n,t,o){if(o=o||e,n.indexOf(" ")>0)return n.split(" ").map(function(n){return e.on(n,t,o)},this),e;n in r||(r[n]=[]);var i=function(e){t.call(o,e,o)};return i.orig=t,r[n].push(i),e},e.one=function(n,t,r){function o(i){e.off(n,o),t.call(r,i,r)}return r=r||e,e.on(n,o)},e.trigger=function(n,t){return n.indexOf(" ")>0?(n.split(" ").forEach(function(n){e.trigger(n,t)}),e):n in r?(r[n].forEach(function(e){e(t)}),e):e},e.fire=function(n,r,o){return t([[n],r],o),e},e.off=function(n,t){return n.indexOf(" ")>0?(n.split(" ").map(function(n){return e.off(n,t)}),e):n in r?(t?r[n]=r[n].map(function(e){return e.orig===t?!1:e}).filter(function(e){return e}):delete r[n],e):e}}function m(e){if("undefined"!=typeof console){var n=console[e[0]]?e[0]:"log";"undefined"==typeof console[n].apply?console[n](e[1].join(" ")):console[n].apply(console,e[1])}}function v(e){function n(n){return function(){for(var t=arguments.length,r=[],o=0;t>o;)r.push(arguments[o]),o++;e.fire("console",[n,r])}}["log","debug","error","info","warn","time","timeEnd"].forEach(function(e){console[e]=n(e)})}function g(e){"function"==typeof e&&(e={data:e});var n="com.catilinejs."+(g._hasWorker?"iframe":"worker")+Math.random(),t=this,r=[];h(t,function(e,n){M._noTransferable?l.postMessage(e):l.postMessage(e,n)});var o=function(e){"string"!=typeof e&&"preventDefault"in e&&(e.preventDefault(),e=e.message),r.forEach(function(n){n&&n.reject(e)})};if(e.__codeWord__=n,e.__initialize__=[L,h,v],"initialize"in e?e.__initialize__.push(e.initialize):"init"in e&&e.__initialize__.push(e.init),"events"in e||(e.events={}),"listners"in e&&"function"!=typeof e.listners)for(var i in e.listners)t.on(i,e.listners[i]);var a="var _db = {\n	",c=function(e){var t=function(t,o){var i=r.length;return r[i]=M.deferred(),M._noTransferable?l.postMessage([[n,i],e,t]):l.postMessage([[n,i],e,t],o),r[i].promise};return t},u=!1;for(var f in e)if(!(["listners","initialize","init"].indexOf(f)>-1))if(u?a+=",\n	":u=!0,"function"==typeof e[f])a=a+f+":"+e[f].toString(),t[f]=c(f);else{var s=M.stringify(e[f]);"undefined"!=typeof s&&(a=a+f+":"+s)}a+="};";var l=M.makeWorker(["'use strict';","",a,"_db.__initialize__.forEach(function(f){","	f.call(_db,_db);","});","for(var key in _db.events){","	_db.on(key,_db.events[key]);","}"],n);l.onmessage=function(e){t.trigger("message",e.data[1]),e.data[0][0]===n?(r[e.data[0][1]].resolve(e.data[1]),r[e.data[0][1]]=0):t.trigger(e.data[0][0],e.data[1])},t.on("error",o),l.onerror=function(e){t.trigger("error",e)},t.on("console",m),t._close=function(){return l.terminate(),o("closed"),M.resolve()},"close"in t||(t.close=t._close)}function y(e,n){return{keyFunc:function(n){return function(t,r){return e(n,t,r)}},keyFuncBatch:function(n){return function(t){return M.all(t.map(function(t){return e(n,t)}))}},keyFuncBatchCB:function(t){return function(r){return M.all(r.map(function(r){return e(t,r).then(n.__cb__)}))}},keyFuncBatchTransfer:function(n){return function(t){return M.all(t.map(function(t){return e(n,t[0],t[1])}))}},keyFuncBatchTransferCB:function(t){return function(r){return M.all(r.map(function(r){return e(t,r[0],r[1]).then(n.__cb__)}))}}}}function b(e,n,t){var r=y(e,n);for(var o in t)n[o]=r.keyFunc(o),n.batch[o]=r.keyFuncBatch(o),n.__batchcb__[o]=r.keyFuncBatchCB(o),n.batchTransfer[o]=r.keyFuncBatchTransfer(o),n.__batchtcb__[o]=r.keyFuncBatchTransferCB(o)}function k(e,n,t){e.on=function(t,r,o){return n.forEach(function(e){e.on(t,r,o)}),e},e.off=function(t,r,o){return n.forEach(function(e){e.off(t,r,o)}),e},e.fire=function(r,o){return n[~~(Math.random()*t)].fire(r,o),e}}function w(e,n){return function(t,r,o,i){return i.promise.cancel=function(e){return i.reject(e)},e[~~(Math.random()*n)][t](r,o).then(function(e){return i.resolve(e)},function(e){return i.reject(e)}),i.promise}}function j(e,n,t){for(var r=[],o=-1;++o<e;)r[o]=new M.Worker(t),n.push(o);return r}function E(e,n,t){function r(e){e=e||"canceled",s=0;var n=f;return f=[],n.forEach(function(n){n[3].reject(e)}),a}function o(e){if(s){var n=f.shift();s--,l[e][n[0]](n[1],n[2]).then(function(t){o(e),n[3].resolve(t)},function(t){o(e),n[3].reject(t)})}else c++,u.push(e)}function i(e,n,r){var i=M.deferred();if(t)return d(e,n,r,i);if(!s&&c){var a=u.pop();c--,i.promise.cancel=function(e){return i.reject(e)},l[a][e](n,r).then(function(e){o(a),i.resolve(e)},function(e){o(a),i.reject(e)})}else if(s||!c){var _=[e,n,r,i];i.promise.cancel=function(e){var n=f.indexOf(_);return n>-1&&(f.splice(n,1),s--),i.reject(e)},s=f.push(_)}return i.promise}var a=this,c=n,u=[],f=[],s=0,l=j(n,u,e);k(a,l,n);var _=function(e,n){return l.forEach(function(t){t.fire(e,n)}),a};a.batch.fire=_,a.batchTransfer.fire=_,a.clearQueue=r,b(i,a,e);var d;t&&(d=w(l,n)),a._close=function(){return M.all(l.map(function(e){return e._close()}))},"close"in a||(a.close=a._close)}function M(e,n,t){return 1===arguments.length||!n||1>=n?new M.Worker(e):new M.Queue(e,n,t)}function T(n){var t=e.cw;n.noConflict=function(r){e.cw=t,r&&(e[r]=n)},e.catiline=n,e.cw=n,"communist"in e||(e.communist=n)}var W,S=e.MutationObserver||e.WebKitMutationObserver;if(S){var O=new S(n),x=document.createElement("div");O.observe(x,{attributes:!0}),addEventListener("unload",function(){O.disconnect(),O=null},!1),W=function(){x.setAttribute("drainQueue","drainQueue")}}else{var R="com.catiline.setImmediate"+Math.random();addEventListener("message",function(e){e.source===window&&e.data===R&&n()},!1),W=function(){postMessage(R,"*")}}var F=[];M.nextTick=function(e){1===F.push(e)&&W()};var B="function";M.deferred=r,M.resolve=function(e){var n={};return n.then=o(n,e,!0),n},M.reject=function(e){var n={};return n.then=o(n,e,!1),n},M.all=function(e){var n=r(),t=e.length,o=0,i=[],a=function(e){return function(r){i[e]=r,o++,o===t&&n.resolve(i)}};return e.forEach(function(e,t){e.then(a(t),function(e){n.reject(e)})}),n.promise},M._hasWorker="undefined"!=typeof Worker&&"undefined"==typeof fakeLegacy,M.URL=window.URL||window.webkitURL,M._noTransferable=!M.URL,M.makeIWorker=function(e,n){var t=c(e.join(""),"');eval(__scripts__);\n"),r={onmessage:function(){}},o=l(t,n);return window.addEventListener("message",function(e){e.data.slice&&e.data.slice(0,n.length)===n&&r.onmessage({data:JSON.parse(e.data.slice(n.length))})}),r.postMessage=function(e){o.then(function(n){n.contentWindow.postMessage(JSON.stringify(e),"*")})},r.terminate=function(){o.then(function(e){document.body.removeChild(e)})},r},M.makeWorker=function(e,n){if(!M._hasWorker)return M.makeIWorker(e,n);var t,r=c(e.join("\n"),"');\n");if(M._noTransferable)return _(r);try{t=new Worker(M.URL.createObjectURL(new Blob([r],{type:"text/javascript"})))}catch(o){try{t=_(r)}catch(i){t=M.makeIWorker(e,n)}}finally{return t}},M.makeUrl=function(e){var n=document.createElement("link");return n.href=e,n.href},M.stringify=function(e){return Array.isArray(e)?p(e):"function"==typeof e||"number"==typeof e||"boolean"==typeof e?e.toString():"string"==typeof e?'"'+e+'"':"[object Object]"===e.toString()?d(e):void 0};var L=function(e){self.__iFrame__="undefined"!=typeof document,self.__self__={onmessage:function(t){return e.trigger("messege",t.data[1]),t.data[0][0]===e.__codeWord__?n(t):(e.trigger(t.data[0][0],t.data[1]),void 0)}},__iFrame__?window.onmessage=function(e){"string"==typeof e.data&&(e={data:JSON.parse(e.data)}),__self__.onmessage(e)}:self.onmessage=__self__.onmessage,__self__.postMessage=function(n,t){if(self._noTransferable||__iFrame__)if(__iFrame__){var r=e.__codeWord__+JSON.stringify(n);window.parent.postMessage(r,"*")}else self._noTransferable&&self.postMessage(n);else self.postMessage(n,t)},self.console={};var n=function(n){var t,r=function(e,t){__self__.postMessage([n.data[0],e],t)};if(__iFrame__)try{t=e[n.data[1]](n.data[2],r,e)}catch(o){e.fire("error",JSON.stringify(o))}else t=e[n.data[1]](n.data[2],r,e);"undefined"!=typeof t&&r(t)}};M.Worker=g,M.worker=function(e){return new g(e)},E.prototype.__batchcb__={},E.prototype.__batchtcb__={},E.prototype.batch=function(e){return"function"==typeof e?(this.__cb__=e,this.__batchcb__):this.clearQueue(e)},E.prototype.batchTransfer=function(e){return"function"==typeof e?(this.__batchtcb__.__cb__=e,this.__batchtcb__):this.clearQueue(e)},M.Queue=E,M.queue=function(e,n,t){return new M.Queue(e,n,t)},M.setImmediate=M.nextTick,"function"==typeof define?define(function(e){return M.SHIM_WORKER_PATH=e.toUrl("./catiline.js"),M}):"undefined"!=typeof module&&"exports"in module?module.exports=M:T(M),M.version="2.9.3"}(this);