(function(){window.tgen||(window.tgen={}),tgen.TriTreeNode=function(){function t(){this.me=0,this.leftNeighbour=0,this.rightNeighbour=0,this.baseNeighbour=0,this.leftChild=0,this.rightChild=0,this.variance=0}return t.prototype.isLeaf=function(){return 0===this.me?!1:0===this.leftChild&&0===this.rightChild?!1:!0},t}(),tgen.Landscape=function(){function t(){var t;this.allocatedTris=0,this.nodeList=function(){var i,e,h;for(h=[],t=i=0,e=this.maxTris;e>=0?e>i:i>e;t=e>=0?++i:--i)h.push(new tgen.TriTreeNode);return h}.call(this)}return t.prototype.maxTris=25e3,t.prototype.MAP_SIZE=128,t.prototype.NUM_PATCHES_PER_SIDE=32,t.prototype.PATCH_SIZE=t.MAP_SIZE/t.NUM_PATCHES_PER_SIDE,t.prototype.setHeightMapProvider=function(t){this.heightMapProvider=t},t.prototype.getHeight=function(t,i,e){return null==e&&(e=0),this.heightMapProvider.get(t,i,e)},t}(),tgen.Patch=function(){function t(t){this.land=t}return t.prototype.init=function(t,i){return this.worldX=t,this.worldY=i,this.baseLeft=this.land.getNextNode(),this.baseRight=this.land.getNextNode(),this.reset()},t.prototype.reset=function(){return this.baseLeft.leftChild=this.baseLeft.rightChild=this.baseRight.leftChild=this.baseRight.rightChild=0,this.baseLeft.leftNeighbour=this.baseLeft.rightNeighbour=this.baseRight.leftNeighbour=this.baseRight.rightNeighbour=0,this.baseLeft.baseNeighbour=this.baseRight.me,this.baseRight.baseNeighbour=this.baseLeft.me},t.prototype.tessellate=function(){return this.buildTriangle(this.baseLeft,this.worldX,this.worldY+this.land.PATCH_SIZE,this.worldX+this.land.PATCH_SIZE,this.worldY,this.worldX,this.worldY),this.buildTriangle(this.baseRight,this.worldX+this.land.PATCH_SIZE,this.worldY,this.worldX,this.worldY+this.land.PATCH_SIZE,this.worldX+this.land.PATCH_SIZE,this.worldY+this.land.PATCH_SIZE)},t.prototype.split=function(t){var i,e;if(t.isLeaf())return 0!==t.baseNeighbour&&this.land.nodes[t.baseNeighbour].baseNeighbour!==t.me&&this.split(land.nodes[t.baseNeighbour]),t.leftChild=this.land.getNextNode(),t.rightChild=this.land.getNextNode(),i=this.land.nodes[t.leftChild],e=this.land.nodes[t.rightChild]},t}()}).call(this);